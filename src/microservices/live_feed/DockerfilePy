# Dockerfile
FROM python:3.10-slim

# system deps for OpenCV & dlib
RUN apt-get update \
 && apt-get install -y --no-install-recommends \
      build-essential cmake libglib2.0-0 libsm6 libxrender1 libfontconfig1 \
 && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy only requirements first (for better caching)
COPY src/microservices/live_feed/requirements.txt .

# Install Python deps without cache
RUN pip install --upgrade pip \
 && pip install --no-cache-dir -r requirements.txt

# Copy your app code
COPY src/microservices/live_feed /app

# Expose whichever port you bind to
EXPOSE 5000

# Use gunicorn binding to Renderâ€™s $PORT
CMD ["gunicorn", "app:app", "--bind", "0.0.0.0:$PORT"]
